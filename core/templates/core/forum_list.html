{% extends 'base.html' %}

{% block content %}
  <h2 class="text-2xl font-bold mb-4">Forum Posts</h2>

  <!-- {% if not request.user.is_staff %}
    <a href="{% url 'forum_create' %}" class="bg-blue-500 text-white px-4 py-2 rounded">Create Post</a>
  {% endif %} -->

  {% if request.user.is_authenticated and not request.user.is_staff %}
    <a href="{% url 'forum_create' %}" class="bg-blue-500 text-white px-4 py-2 rounded">Create Post</a>
  {% endif %}


  <div class="mt-4 space-y-4">
    {% for post in posts %}
      <div class="border p-4 rounded shadow bg-white">
        <h3 class="text-xl font-semibold">{{ post.title }}</h3>
        <p class="text-gray-700">{{ post.content }}</p>
        <p class="text-sm text-gray-500">By {{ post.author.first_name }} {{ post.author.last_name }} | {{ post.date_posted|date:"F j, Y g:i A" }}
        </p>
        <!-- <p class="text-sm text-gray-500">Visibility: {{ post.visibility.get_visibility_type_display }}</p> -->

        {% if post.author == request.user %}
          <div class="mt-2 space-x-2">
            <a href="{% url 'forum_update' post.id %}" class="text-blue-500">Edit</a>
            <a href="{% url 'forum_delete' post.id %}" class="text-red-500">Delete</a>
          </div>
        {% elif request.user.is_staff %}
          <div class="mt-2">
            <a href="{% url 'forum_delete' post.id %}" class="text-red-500">Delete</a>
          </div>
        {% endif %}
      </div>
    {% empty %}
    <div class="text-gray-500 italic">No posts available. Be the first to post!</div>

    {% endfor %}
  </div>
{% endblock %}
