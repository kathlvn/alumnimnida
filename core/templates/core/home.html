{% extends 'base.html' %}
{% load static %}

{% block title %}Home{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/style.css' %}">
{% endblock %}

{% block page_title %}
Welcome back, {{ user.full_name }}!
{% endblock %}

{% block content %}
{% load humanize %}
<!-- Upcoming Events -->
<div class="event-box">
<div class="forum-post">
  <h3>UPCOMING EVENTS</h3>
  {% for event in upcoming_events|slice:":5" %}
    <div class="item-row">
      <div>
        <strong>{{ event.date|date:"F d" }}</strong> &nbsp;
        <span style="font-weight: bold;">{{ event.title }}</span><br>
        <em>{{ event.location }}</em>
      </div>
      <a href="{% url 'event_detail' event.id %}" class="view-button">View Details</a>
    </div>
  {% empty %}
    <p>No upcoming events.</p>
  {% endfor %}
</div>
</div>

<!-- Recent Updates -->
<div class="event-box">
<div class="forum-post">
  <h3>RECENT UPDATES</h3>
  {% for update in recent_updates|slice:":3" %}
    <div class="item-row">
      <div>
        <strong>{{ update.title }}</strong><br>
        <em>{{ update.date_posted|timesince }} ago</em>
      </div>
      <a href="{% url 'update_detail' update.id%}" class="view-button">View Details</a> 
    </div>
  {% empty %}
    <p>No recent updates.</p>
  {% endfor %}
</div>
</div>
{% endblock %}


{% block right_panel %}
<div style="text-align: center; margin-bottom: 20px;">
  <img src="{% static 'img/user_icon.png' %}" alt="Profile" style="width: 60px;">
  <h3>{{ user.full_name }}</h3>
  <em>Class of {{ user.year_graduated }}</em>
  <br>
  <a href="{% url 'profile' %}">
    <button class="view-button">Edit Profile</button>
  </a>

  <h3>Your Engagements</h3>
  <div class="info-row">
    <span class="label">Forum Posts:</span>
    <span class="value">{{ forum_posts_count }}</span>
  </div>
  <div class="info-row">
    <span class="label">Comments made:</span>
    <span class="value">{{ comments_count }}</span>
  </div>
  <div class="info-row">
    <span class="label">Events Attended:</span>
    <span class="value">{{ events_attended_count }}</span>
  </div>
</div>
{% endblock %}