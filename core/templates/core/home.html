{% extends 'base.html' %}
{% load static %}
{% load humanize %}

{% block title %}Home{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/style.css' %}">
{% endblock %}

{% block page_title %}
Welcome back!
{% endblock %}

{% block content %}
<!-- Upcoming Events -->
<div class="event-box">
  <div class="forum-post">
    <h3>UPCOMING EVENTS</h3>
    {% for event in upcoming_events|slice:":5" %}
      <div class="item-row">
        <div>
          <strong>{{ event.date|date:"F d" }}</strong> &nbsp;
          <span style="font-weight: bold;">{{ event.title }}</span><br>
          <em>{{ event.location }}</em>
        </div>
      </div>
    {% empty %}
      <p>No upcoming events.</p>
    {% endfor %}
    <div style="text-align: right; margin-top: 10px;">
      <a href="{% url 'events' %}" class="view-button">View All Events</a>
    </div>
  </div>
</div>

<!-- Recent Updates -->
<div class="event-box">
  <div class="forum-post">
    <h3>RECENT UPDATES</h3>
    {% for update in recent_updates|slice:":3" %}
      <div class="item-row">
        <div>
          <strong>{{ update.title }}</strong><br>
          <em>{{ update.date_posted|timesince }} ago</em>
        </div>
      </div>
    {% empty %}
      <p>No recent updates.</p>
    {% endfor %}
    <div style="text-align: right; margin-top: 10px;">
      <a href="{% url 'updates' %}" class="view-button">View All Updates</a>
    </div>
  </div>
</div>
{% endblock %}

{% block right_panel %}
<div style="text-align: center; margin-bottom: 20px;">
  {% if user.profile_picture %}
    <img src="{{ user.profile_picture.url }}" alt="Profile Picture" style="width: 80px; height: 80px; object-fit: cover; border-radius: 50%;">
  {% else %}
    <img src="{% static 'default/profile.png' %}" alt="Default Profile Picture" style="width: 60px;">
  {% endif %}
  <h3>{{ user.full_name }}</h3>
  <em>Class of {{ user.year_graduated }}</em>
  <br>
  <a href="{% url 'profile' %}">
    <button class="view-button">Edit Profile</button>
  </a>

  <h3>Your Engagements</h3>
  <div class="info-row">
    <span class="label">Forum Posts:</span>
    <span class="value">{{ forum_posts_count }}</span>
  </div>
  <div class="info-row">
    <span class="label">Comments made:</span>
    <span class="value">{{ comments_count }}</span>
  </div>
</div>
{% endblock %}

{% block scripts %}
<!-- No modal script needed anymore -->
{% endblock %}
