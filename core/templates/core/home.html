{% extends 'base.html' %}
{% load static %}

{% block title %}Home{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/style.css' %}">
{% endblock %}

{% block page_title %}
Welcome back, {{ user.full_name }}!
{% endblock %}

{% block content %}
<!-- Upcoming Events -->
<div class="forum-post">
  <h3>UPCOMING EVENTS</h3>
  {% for event in upcoming_events %}
    <div style="margin-bottom: 15px;">
      <strong>{{ event.date|date:"F d" }}</strong> &nbsp;
      <span style="font-weight: bold;">{{ event.title }}</span><br>
      <em>{{ event.location }}</em><br>
      <a href="{% url 'event_detail' event.id %}">
        <button class="attend-button">View Details</button>
      </a>
    </div>
  {% empty %}
    <p>No upcoming events.</p>
  {% endfor %}
</div>

<!-- Recent Updates -->
<div class="forum-post">
  <h3>RECENT UPDATES</h3>
  {% for update in recent_updates %}
    <div style="margin-bottom: 10px;">
      <strong>{{ update.title }}</strong><br>
      <em>{{ update.posted_at|timesince }} ago</em><br>
      <a href="{% url 'update_detail' update.id %}">
        <button class="attend-button">View Details</button>
      </a>
    </div>
  {% empty %}
    <p>No recent updates.</p>
  {% endfor %}
</div>
{% endblock %}

{% block right_panel %}
<div style="text-align: center; margin-bottom: 20px;">
  <img src="{% static 'img/user_icon.png' %}" alt="Profile" style="width: 60px;">
  <h3>{{ user.full_name }}</h3>
  <em>Class of {{ user.year_graduated }}</em>
  <a href="{% url 'profile' %}">
    <button class="attend-button">Edit Profile</button>
  </a>

  <h3>Your Engagements</h3>
  <div class="info-row">
    <span class="label">Forum Posts:</span>
    <span class="value">{{ forum_posts_count }}</span>
  </div>
  <div class="info-row">
    <span class="label">Comments made:</span>
    <span class="value">{{ comments_count }}</span>
  </div>
  <div class="info-row">
    <span class="label">Events Attended:</span>
    <span class="value">{{ events_attended_count }}</span>
  </div>
</div>
{% endblock %}